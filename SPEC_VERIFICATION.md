# 仕様準拠確認レポート

実施日: 2026-02-19  
対象: `SPECIFICATION.md` と現行実装（`app/`, `src/`）の突合

## 判定サマリ

- **全体判定**: 概ね仕様どおり（MVP実装として主要機能は網羅）
- **補足**: 仕様書内の「今後のタスク（Phase 1/2）」に記載された項目は、現時点で未完了が含まれる前提

## 1) 技術スタック / 構成

| 項目 | 判定 | 確認内容 |
|---|---|---|
| Expo + TypeScript | ✅ | `package.json`, `tsconfig.json`, `index.ts` で構成確認 |
| Expo Router（ファイルベース） | ✅ | `app/` 配下のルート構成を確認 |
| SQLite ローカル永続化 | ✅ | `src/db/database.ts` にテーブル初期化とCRUD実装あり |
| Gesture/Reanimated | ✅ | `app/question/[id].tsx` で Pinch/Pan/DoubleTap を使用 |
| Ionicons | ✅ | 各画面で `@expo/vector-icons` を使用 |

## 2) データモデル（SQLite）

| テーブル | 判定 | 備考 |
|---|---|---|
| `attempts` | ✅ | 仕様の主要カラムを実装 |
| `review_queue` | ✅ | `problemId`, `nextReviewAt`, `stage` を実装 |
| `problem_notes` | ✅ | `bookmarked`, `tags`, `memo` を実装 |
| `session_state` | ✅ | JSON保存で中断再開対応 |
| `test_results` | ✅ | セッション結果を JSON と共に保存 |
| `settings` | ✅ | key-value 管理を実装 |

## 3) 画面仕様

| 画面 | 判定 | 確認内容 |
|---|---|---|
| ホーム | ✅ | クイック開始、復習/スピード、再開、おすすめ、進捗、カテゴリ導線あり |
| 学習 | ✅ | カテゴリタブ、フィルタ（未学習/間違い/正解/ブクマ/苦手）を実装 |
| 1問 | ✅ | タイマー、選択肢確定、解説、タグ、計算メモ、ズーム/ドラッグ対応 |
| テスト | ✅ | プリセット、弱点、カスタム、履歴導線あり |
| テストセッション | ✅ | カウントダウン、問題番号ナビ、旗、即確定モード対応 |
| テスト結果 | ✅ | スコア/グレード、カテゴリ別、個別回答、復習キュー登録あり |
| データ | ✅ | 期間切替、サマリ、日別、カテゴリ別、遅い問題表示あり |
| 設定 | ✅ | タイマー/学習モード/再開時挙動/オフライン/データリセット/情報あり |

## 4) 出題ロジック / 間隔反復

| 項目 | 判定 | 確認内容 |
|---|---|---|
| クイック学習の優先選出 | ✅ | `src/logic/sessionPicker.ts` に優先ロジック実装 |
| 間隔反復 | ✅ | `src/logic/reviewScheduler.ts` で stage/間隔管理 |
| カテゴリ別目標時間 | ✅ | `src/constants/categories.ts` でカテゴリ別に保持 |

## 5) 仕様との差分・注意点

1. **実図表画像の同梱は未完了想定**  
   `Problem.imageUri` は定義されているが、サンプルデータ中心のため「実際の図表画像追加」は継続タスク扱い。
2. **オフライン完全対応は段階実装**  
   設定項目はあるが、仕様書の「問題データ事前DLの完全実装」は今後タスクとして妥当。
3. **型チェックの実行環境依存エラー**  
   CI/ローカル依存関係未解決環境では `tsc` が失敗するため、品質ゲートとしては依存解決後の再確認が必要。

## 結論

- **ユーザー機能の観点では、仕様書のMVP要件に対して実装は概ね充足。**
- **未完項目は仕様書自身の「今後のタスク」に合致する範囲で、重大な仕様逸脱は確認されず。**
